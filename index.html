<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vedant Haldankar - AI Chatbot</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom scrollbar for a cleaner look */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #2D3748; /* bg-gray-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #4A5568; /* bg-gray-600 */
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096; /* bg-gray-500 */
        }
        /* Simple typing indicator animation */
        .typing-dot {
            animation: bounce 1.4s infinite;
        }
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes bounce {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1.0); }
        }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans">

    <div class="flex h-screen">
        <!-- Sidebar -->
        <nav class="w-64 bg-gray-800 p-4 flex flex-col hidden sm:flex">
            <h1 class="text-xl font-bold mb-6">Vedant Haldankar</h1>
            <button class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-lg text-left transition duration-200">
                + New Chat
            </button>
            <!-- Add new chat history items here -->
        </nav>

        <!-- Main Chat Area -->
        <main class="flex-1 flex flex-col h-screen">
            <!-- Header -->
            <header class="bg-gray-800 p-4 text-center sm:hidden">
                <h1 class="text-xl font-bold">Vedant Haldankar</h1>
            </header>

            <!-- Chat Window -->
            <div id="chat-window" class="flex-1 p-6 overflow-y-auto">
                <!-- Chat messages will be appended here -->
                <div class="bg-gray-700 p-4 rounded-lg max-w-lg mb-4">
                    <p class="font-bold mb-1">AI Assistant</p>
                    <p>Hello! I'm Vedant Haldankar's AI assistant. How can I help you today?</p>
                </div>
            </div>

            <!-- Typing Indicator -->
            <div id="typing-indicator" class="p-6 pt-0 hidden">
                <div class="bg-gray-700 p-4 rounded-lg max-w-lg inline-block">
                    <div class="flex items-center space-x-1">
                        <div class="typing-dot w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="typing-dot w-2 h-2 bg-gray-300 rounded-full"></div>
                        <div class="typing-dot w-2 h-2 bg-gray-300 rounded-full"></div>
                    </div>
                </div>
            </div>

            <!-- Input Area -->
            <div class="p-6 pt-2 bg-gray-900">
                <form id="chat-form" class="flex items-center bg-gray-700 rounded-lg p-2">
                    <input type="text" id="message-input" placeholder="Send a message..." class="flex-1 bg-transparent border-none text-white placeholder-gray-400 focus:outline-none focus:ring-0" autocomplete="off">
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg ml-2">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18" />
                        </svg>
                    </button>
                </form>
                <p class="text-center text-xs text-gray-500 mt-2">
                    This is a custom-built AI. Responses are generated by an AI model.
                </p>
            </div>
        </main>
    </div>

    <script>
        // Get DOM elements
        const chatWindow = document.getElementById('chat-window');
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const typingIndicator = document.getElementById('typing-indicator');

        // --- IMPORTANT ---
        // REPLACE 'YOUR_API_KEY_HERE' WITH YOUR ACTUAL OPENAI API KEY
        const apiKey = 'YOUR_API_KEY_HERE';
        const apiUrl = 'https://api.openai.com/v1/chat/completions';

        // This array will store the chat history for context
        const messages = [
            {
                role: "system",
                content: "You are a helpful assistant. The user is interacting with a chatbot named 'Vedant Haldankar'."
            },
            {
                role: "assistant",
                content: "Hello! I'm Vedant Haldankar's AI assistant. How can I help you today?"
            }
        ];

        // Handle form submission
        chatForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const userMessage = messageInput.value.trim();

            if (!userMessage) return;

            // Add user's message to the UI
            addMessageToUI(userMessage, 'user');

            // Add user's message to the history
            messages.push({ role: "user", content: userMessage });

            // Clear the input field
            messageInput.value = '';

            // Show typing indicator
            showTypingIndicator();

            try {
                // Check if API key is set
                if (apiKey === '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') {
                    addMessageToUI("Error: API key is not set. Please set your API key in the JavaScript code.", 'ai', true);
                    hideTypingIndicator();
                    return;
                }
                
                // Make the API call
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${apiKey}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-3.5-turbo', // You can change this to gpt-4 if you have access
                        messages: messages
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(`API Error: ${response.status} - ${errorData.error.message}`);
                }

                const data = await response.json();
                const aiMessage = data.choices[0].message.content;

                // Add AI's message to the history
                messages.push({ role: "assistant", content: aiMessage });

                // Add AI's message to the UI
                addMessageToUI(aiMessage, 'ai');

            } catch (error) {
                console.error(error);
                addMessageToUI(`Error: ${error.message}. Please check your API key and console for details.`, 'ai', true);
            } finally {
                // Hide typing indicator
                hideTypingIndicator();
            }
        });

        // Function to add a message to the chat window
        function addMessageToUI(message, sender, isError = false) {
            const messageElement = document.createElement('div');
            let senderName = "AI Assistant";
            let senderClasses = "bg-gray-700 max-w-lg";

            if (sender === 'user') {
                senderName = "You";
                senderClasses = "bg-blue-600 max-w-lg ml-auto"; // User messages align right
            } else if (isError) {
                senderClasses = "bg-red-700 max-w-lg";
            }
            
            messageElement.className = `${senderClasses} p-4 rounded-lg mb-4`;
            
            // Format the message with line breaks
            const formattedMessage = message.replace(/\n/g, '<br>');

            messageElement.innerHTML = `
                <p class="font-bold mb-1">${senderName}</p>
                <p>${formattedMessage}</p>
            `;
            chatWindow.appendChild(messageElement);

            // Scroll to the bottom
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        // Function to show the typing indicator
        function showTypingIndicator() {
            typingIndicator.classList.remove('hidden');
            chatWindow.scrollTop = chatWindow.scrollHeight;
        }

        // Function to hide the typing indicator
        function hideTypingIndicator() {
            typingIndicator.classList.add('hidden');
        }
    </script>
</body>
</html>
